@page "/AdminDashboardPage"
@page "/dashboard"
@using MudBlazor

<MudPaper Class="p-4" Style="height:100vh; overflow:hidden; background-color:#F9FAFB;">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <MudText Typo="Typo.h5" Class="fw-bold text-primary">Inventory & Funds Dashboard</MudText>
        <MudText Typo="Typo.subtitle2" Color="Color.Secondary">As of @DateTime.Now.ToString("MMMM dd, yyyy")</MudText>
    </div>

    <!-- Top Cards -->
    <div class="d-flex justify-content-between mb-4" style="gap:1rem;">
        <MudCard Class="flex-fill text-center shadow-sm" Style="border-left:5px solid #1976d2;">
            <MudCardContent>
                <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Total Inventory Value</MudText>
                <MudText Typo="Typo.h6" Class="fw-bold text-primary">Rs. 8,540,000</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="flex-fill text-center shadow-sm" Style="border-left:5px solid #2e7d32;">
            <MudCardContent>
                <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Funds Available</MudText>
                <MudText Typo="Typo.h6" Class="fw-bold text-success">Rs. 3,250,000</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="flex-fill text-center shadow-sm" Style="border-left:5px solid #ed6c02;">
            <MudCardContent>
                <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Outstanding Payments</MudText>
                <MudText Typo="Typo.h6" Class="fw-bold text-warning">Rs. 1,150,000</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="flex-fill text-center shadow-sm" Style="border-left:5px solid #d32f2f;">
            <MudCardContent>
                <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Stock Alerts</MudText>
                <MudText Typo="Typo.h6" Class="fw-bold text-error">12 Items</MudText>
            </MudCardContent>
        </MudCard>
    </div>

    <!-- Middle Section -->
    <div class="d-flex justify-content-between" style="gap:1rem; height:40vh;">
        <!-- Inventory Chart -->
        <MudPaper Class="flex-fill p-3 shadow-sm">
            <MudText Typo="Typo.subtitle1" Class="fw-bold mb-2 text-primary">Inventory Distribution</MudText>
            <MudChart ChartType="ChartType.Pie"
                      Labels="_inventoryLabels"
                      InputData="_inventoryData"
                      Style="height:32vh;">
            </MudChart>
        </MudPaper>

        <!-- Funds Chart -->
        <MudPaper Class="flex-fill p-3 shadow-sm">
            <MudText Typo="Typo.subtitle1" Class="fw-bold mb-2 text-primary">Monthly Funds Flow</MudText>
            <!-- Funds Chart -->
            <MudPaper Class="p-3 flex-grow-1" Style="width:48%; height:300px;">
                <MudText Typo="Typo.h6" Class="mb-2 fw-bold">Funds Trend</MudText>
                <MudChart ChartType="ChartType.Line"
                          Labels="_fundsLabels"
                          Style="height:240px;" />
            </MudPaper>

            <!-- Inventory Chart -->
            <MudPaper Class="p-3 flex-grow-1" Style="width:48%; height:300px;">
                <MudText Typo="Typo.h6" Class="mb-2 fw-bold">Inventory Overview</MudText>
                <MudChart ChartType="ChartType.Bar"
                          Labels="_inventoryLabels"
                          Style="height:240px;" />
            </MudPaper>
        </MudPaper>
    </div>

    <!-- Bottom Tables -->
    <div class="d-flex justify-content-between mt-4" style="gap:1rem; height:25vh;">
        <MudPaper Class="flex-fill p-2 shadow-sm">
            <MudText Typo="Typo.subtitle1" Class="fw-bold mb-2 text-primary">Low Stock Items</MudText>
            <MudTable Items="_lowStock" Dense="true" Hover="true">
                <HeaderContent>
                    <MudTh>Item</MudTh>
                    <MudTh>Qty</MudTh>
                    <MudTh>Reorder Level</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Item">@context.ItemName</MudTd>
                    <MudTd DataLabel="Qty">@context.Quantity</MudTd>
                    <MudTd DataLabel="Reorder Level">@context.ReorderLevel</MudTd>
                </RowTemplate>
            </MudTable>
        </MudPaper>

        <MudPaper Class="flex-fill p-2 shadow-sm">
            <MudText Typo="Typo.subtitle1" Class="fw-bold mb-2 text-primary">Recent Transactions</MudText>
            <MudTable Items="_transactions" Dense="true" Hover="true">
                <HeaderContent>
                    <MudTh>Date</MudTh>
                    <MudTh>Description</MudTh>
                    <MudTh class="text-end">Amount</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Date">@context.Date.ToString("dd MMM")</MudTd>
                    <MudTd DataLabel="Description">@context.Description</MudTd>
                    <MudTd DataLabel="Amount" Class="text-end">@context.Amount.ToString("C0")</MudTd>
                </RowTemplate>
            </MudTable>
        </MudPaper>
    </div>
</MudPaper>

@code {
    private string[] _inventoryLabels = { "Electronics", "Stationery", "Furniture", "Accessories" };
    private double[] _inventoryData = { 4500000, 1200000, 1800000, 1040000 };

    private string[] _fundsLabels = { "Jan", "Feb", "Mar", "Apr", "May", "Jun" };


    // Data arrays must be double[][]
    private double[][] _fundsDataList = new double[][]
    {
        new double[] { 1000, 1500, 1200, 1800, 2000, 2300 }  // One series
    };

    private double[][] _inventoryDataList = new double[][]
    {
        new double[] { 500, 700, 300, 900 } // One series
    };
    private List<LowStockModel> _lowStock = new()
    {
        new() { ItemName = "Printer Ink", Quantity = 4, ReorderLevel = 10 },
        new() { ItemName = "A4 Paper Ream", Quantity = 12, ReorderLevel = 20 },
        new() { ItemName = "Mouse", Quantity = 5, ReorderLevel = 10 },
        new() { ItemName = "Keyboard", Quantity = 3, ReorderLevel = 5 }
    };

    private List<TransactionModel> _transactions = new()
    {
        new() { Date = DateTime.Now.AddDays(-1), Description = "Office Supplies Purchase", Amount = -25000 },
        new() { Date = DateTime.Now.AddDays(-2), Description = "Customer Payment", Amount = 100000 },
        new() { Date = DateTime.Now.AddDays(-3), Description = "Equipment Maintenance", Amount = -18000 },
        new() { Date = DateTime.Now.AddDays(-4), Description = "Vendor Refund", Amount = 15000 }
    };

    public class LowStockModel
    {
        public string? ItemName { get; set; } = string.Empty;
        public int Quantity { get; set; }
        public int ReorderLevel { get; set; }
    }

    public class TransactionModel
    {
        public DateTime Date { get; set; }
        public string? Description { get; set; } = string.Empty;
        public double Amount { get; set; }
    }
}
