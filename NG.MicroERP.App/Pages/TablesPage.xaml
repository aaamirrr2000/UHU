<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NG.MicroERP.App.Pages.TablesPage"
             BackgroundColor="White"
             NavigationPage.HasNavigationBar="False"
             Title="TablesPage">

    <ContentPage.Background>
        <LinearGradientBrush EndPoint="0,1">
            <GradientStop Color="#E6F0FA" Offset="0.0" />
            <GradientStop Color="#FFFFFF" Offset="1.0" />
        </LinearGradientBrush>
    </ContentPage.Background>
    
    <ScrollView>
        <Grid Padding="10">

            <Border StrokeThickness="0"
                    Margin="5"
                    Padding="5"
                    BackgroundColor="White"
                    HorizontalOptions="Fill"
                    StrokeShape="RoundRectangle 15">
                <Border.Shadow>
                    <Shadow Brush="#20000000" Offset="0,5" Radius="10" Opacity="0.3" />
                </Border.Shadow>
                
                <VerticalStackLayout Spacing="20">
                    <Label Text="Tables"
                       FontSize="28"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       TextColor="#333"
                       FontFamily="Orbitron" />

                    <ActivityIndicator x:Name="LoadingIndicator"
                                     IsVisible="False"
                                     IsRunning="False"
                                     Color="#00C4B4"
                                     HeightRequest="40" />

                    <RefreshView x:Name="refreshView" IsRefreshing="False" Refreshing="OnRefresh">


                        <CollectionView x:Name="TablesPageRef"
                                ItemsSource="{Binding Tables}"
                                SelectionMode="Single"
                                SelectionChanged="TablesCollectionView_SelectionChanged">
                        
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Vertical" ItemSpacing="2" />
                        </CollectionView.ItemsLayout>

                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border StrokeThickness="0"
                                        Margin="10"
                                        Padding="20"
                                        BackgroundColor="#F0F1F3"
                                        HorizontalOptions="Fill"
                                        StrokeShape="RoundRectangle 15">

                                    <Grid ColumnDefinitions="*, Auto"
                                      RowDefinitions="Auto"
                                      ColumnSpacing="10"
                                      VerticalOptions="Center"
                                      HorizontalOptions="Fill"
                                      Padding="0">

                                        <HorizontalStackLayout Grid.Column="0"
                                                           Spacing="10"
                                                           VerticalOptions="Center"
                                                           HorizontalOptions="Start">

                                            <Image Source="{Binding TableImage}"
                                               WidthRequest="36"
                                               VerticalOptions="Center" />

                                            <VerticalStackLayout Spacing="2"
                                                             VerticalOptions="Center"
                                                             HorizontalOptions="Start">
                                                
                                                <Label Text="{Binding TableNumber}"
                                                   FontAttributes="Bold"
                                                   TextColor="Black"
                                                   CharacterSpacing="2"
                                                   FontSize="16"/>

                                                <Label Text="{Binding Capacity, StringFormat='Capacity: {0} Persons'}"
                                                   FontSize="13"
                                                   TextColor="Gray"/>

                                                <!--<Label Text="{Binding AvailableStatus}"
                                                   FontSize="13"
                                                   TextColor="Black" />-->
                                            </VerticalStackLayout>

                                        </HorizontalStackLayout>

                                        <!-- Right side: Buttons -->
                                        <HorizontalStackLayout Grid.Column="1"
                                                           Spacing="10"
                                                           VerticalOptions="Center"
                                                           HorizontalOptions="End">

                                        </HorizontalStackLayout>

                                    </Grid>

                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer
                                        Command="{Binding BindingContext.TableTappedCommand, Source={x:Reference TablesPageRef}}"
                                        CommandParameter="{Binding .}" />
                                    </Border.GestureRecognizers>

                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    </RefreshView>

                </VerticalStackLayout>
            </Border>
        </Grid>
    </ScrollView>
</ContentPage>
